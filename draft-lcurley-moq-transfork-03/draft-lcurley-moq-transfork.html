<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Media over QUIC - Transfork</title>
<meta content="Luke Curley" name="author">
<meta content="
       MoqTransfork is designed to serve live tracks over a CDN to viewers with varying latency and quality targets: the entire spectrum between real-time and VOD.
MoqTransfork itself is a media agnostic transport, allowing relays and CDNs to forward the most important content under degraded networks without knowledge of codecs, containers, or even if the content is fully encrypted.
Higher level protocols specify how to use MoqTransfork to encode and deliver video, audio, messages, or any form of live content. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="draft-lcurley-moq-transfork-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-lcurley-moq-transfork.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">moqtf</td>
<td class="right">January 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Curley</td>
<td class="center">Expires 20 July 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">moq</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-lcurley-moq-transfork-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-01-16" class="published">16 January 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-07-20">20 July 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">L. Curley</div>
<div class="org">Discord</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Media over QUIC - Transfork</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">MoqTransfork is designed to serve live tracks over a CDN to viewers with varying latency and quality targets: the entire spectrum between real-time and VOD.
MoqTransfork itself is a media agnostic transport, allowing relays and CDNs to forward the most important content under degraded networks without knowledge of codecs, containers, or even if the content is fully encrypted.
Higher level protocols specify how to use MoqTransfork to encode and deliver video, audio, messages, or any form of live content.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Media Over QUIC Working Group mailing list (moq@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/moq/">https://mailarchive.ietf.org/arch/browse/moq/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/kixelated/moq-drafts">https://github.com/kixelated/moq-drafts</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 July 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-fork" class="internal xref">Fork</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-concepts" class="internal xref">Concepts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-session" class="internal xref">Session</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-track" class="internal xref">Track</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-group" class="internal xref">Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-frame" class="internal xref">Frame</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-liveliness" class="internal xref">Liveliness</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-workflow" class="internal xref">Workflow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-connection" class="internal xref">Connection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-termination" class="internal xref">Termination</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-handshake" class="internal xref">Handshake</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-streams" class="internal xref">Streams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-bidirectional-streams" class="internal xref">Bidirectional Streams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-session-2" class="internal xref">Session</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-announce" class="internal xref">Announce</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-subscribe" class="internal xref">Subscribe</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-fetch" class="internal xref">Fetch</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-info" class="internal xref">Info</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-unidirectional-streams" class="internal xref">Unidirectional Streams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="auto internal xref">5.5.1</a>.  <a href="#name-group-2" class="internal xref">Group</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-encoding" class="internal xref">Encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-stream_type" class="internal xref">STREAM_TYPE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-session_client" class="internal xref">SESSION_CLIENT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-session_server" class="internal xref">SESSION_SERVER</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-session_update" class="internal xref">SESSION_UPDATE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-announce_please" class="internal xref">ANNOUNCE_PLEASE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-announce-2" class="internal xref">ANNOUNCE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-subscribe-2" class="internal xref">SUBSCRIBE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-subscribe_update" class="internal xref">SUBSCRIBE_UPDATE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-subscribe_gap" class="internal xref">SUBSCRIBE_GAP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-info-2" class="internal xref">INFO</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.11">
                <p id="section-toc.1-1.6.2.11.1"><a href="#section-6.11" class="auto internal xref">6.11</a>. <a href="#name-info_please" class="internal xref">INFO_PLEASE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.12">
                <p id="section-toc.1-1.6.2.12.1"><a href="#section-6.12" class="auto internal xref">6.12</a>. <a href="#name-fetch-2" class="internal xref">FETCH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.13">
                <p id="section-toc.1-1.6.2.13.1"><a href="#section-6.13" class="auto internal xref">6.13</a>. <a href="#name-fetch_update" class="internal xref">FETCH_UPDATE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.14">
                <p id="section-toc.1-1.6.2.14.1"><a href="#section-6.14" class="auto internal xref">6.14</a>. <a href="#name-group-3" class="internal xref">GROUP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.15">
                <p id="section-toc.1-1.6.2.15.1"><a href="#section-6.15" class="auto internal xref">6.15</a>. <a href="#name-frame-2" class="internal xref">FRAME</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-appendix-changelog" class="internal xref">Appendix: Changelog</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-moq-transfork-03" class="internal xref">moq-transfork-03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-moq-transfork-02" class="internal xref">moq-transfork-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-moq-transfork-01" class="internal xref">moq-transfork-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-moq-transfork-00" class="internal xref">moq-transfork-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-1">
      <h2 id="name-conventions-and-definitions">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fork">
<section id="section-2">
      <h2 id="name-fork">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-fork" class="section-name selfRef">Fork</a>
      </h2>
<p id="section-2-1">This draft is based on moq-transport-03 <span>[<a href="#moqt" class="cite xref">moqt</a>]</span>.
The concepts, motivations, and terminology are very similar on purpose.
When in doubt, refer to the upstream draft.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">I absolutely believe in the motivation and potential of Media over QUIC.
The layering is phenomenal and addresses many of the problems with current live media protocols.
I fully support the goals of the working group and the IETF process.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">But there are practical and conceptual flaws with MoqTransport that need to be addressed.
However it's been difficult to design such an experimental protocol via committee.
Despite years of arguments in person and on GitHub, we've yet to align on even the most critical property of the transport... how to utilize QUIC.
The result is inevitably an unwieldy "compromise", consisting of a modes for each party that make everything more difficult to support or explain.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">In our RUSH to standardize a protocol, the QUICR solutions have led to WARP in ideals.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">This fork is meant to be a constructive, alternative vision.
I would like to lead by example, demonstrating that you can support real media use-cases while simplifying the protocol.
The working group will keep making progress and hopefully many of these ideas will be incorporated.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">The appendix contains a list of high level differences between MoqTransport and MoqTransfork.<a href="#section-2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="concepts">
<section id="section-3">
      <h2 id="name-concepts">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-concepts" class="section-name selfRef">Concepts</a>
      </h2>
<p id="section-3-1">MoqTransfork consists of:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1"><strong>Session</strong>: An established connection between a client and server used to transmit any number of Tracks by path.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1"><strong>Track</strong>: An series of Groups, each of which is delivered and decoded <em>independently</em>.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1"><strong>Group</strong>: An series of Frames, each of which is delivered and decoded *in orde.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.4">
          <p id="section-3-2.4.1"><strong>Frame</strong>: A sized payload of bytes representing a single moment in time.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-3">The application determines how to split data into tracks, groups, and frames.
MoqTransfork is responsible for the caching and delivery by utilizing rules encoded in headers.
This provides robust and generic one-to-many transmission, even for latency sensitive applications.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="session">
<section id="section-3.1">
        <h3 id="name-session">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-session" class="section-name selfRef">Session</a>
        </h3>
<p id="section-3.1-1">A Session consists of a connection between a QUIC client and server.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">A session is established after the necessary QUIC, WebTransport, and MoqTransfork handshakes.
The MoqTransfork handshake consists of version and extension negotiation.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">The intent is that sessions are chained together via relays.
A broadcaster could establish a session with an CDN ingest edge while the viewers establish separate sessions to CDN distribution edges.
A MoqTransfork session is hop-by-hop, but the application should be designed end-to-end.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="track">
<section id="section-3.2">
        <h3 id="name-track">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-track" class="section-name selfRef">Track</a>
        </h3>
<p id="section-3.2-1">A Track is a series of Groups identified by a unique path.
A MoqTransfork session is used to publish and subscribe to multiple, potentially unrelated, tracks.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">A Track path consists of string parts used to route subscriptions to the correct publisher.
The application determines the structure and encoding of the path.
A Track path <span class="bcp14">MUST</span> be unique within a Session and <span class="bcp14">SHOULD</span> contain entropy to avoid collisions with other sessions, for example timestamps or random values.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">A publisher can advertise available tracks via an ANNOUNCE message.
This allows a subscriber to dynamically discover available tracks based on a prefix.
For example: <code>["meeting", "1234", "alice"]</code> and <code>["meeting", "1234", "bob"]</code>
Alternatively, the application can discover tracks via an out-of-band mechanism.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Each subscription is scoped to a single Track.
A subscription will always start at a Group boundary, either the latest group or a specified sequence number.
A subscriber chooses the ordering and priority of each subscription, hinting to the publisher which Track should arrive first during congestion.
This is critical for a decent user experience during network degradation and the core reason why QUIC can offer real-time latency.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="group">
<section id="section-3.3">
        <h3 id="name-group">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-group" class="section-name selfRef">Group</a>
        </h3>
<p id="section-3.3-1">A Group is an ordered stream of Frames within a Track.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">A group is served by a dedicated QUIC stream which may be closed on completion, reset by the publisher, or cancelled by the subscriber.
An active subscription involves delivering multiple potential concurrent groups.
The Frames within a Group will arrive reliably and in order thanks to the QUIC stream.
However, Groups within a Track can arrive in any order or not at all, and which the application should be prepared to handle.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">A subscriber may FETCH a specific group starting at a given byte offset.
This is similar to a HTTP request and may be used to recover from partial failures among other things.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frame">
<section id="section-3.4">
        <h3 id="name-frame">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-frame" class="section-name selfRef">Frame</a>
        </h3>
<p id="section-3.4-1">A Frame is a payload of bytes within a Group.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">A frame is used to represent a chunk of data with a known size.
A frame should represent a single moment in time and avoid any buffering that would increase latency.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="liveliness">
<section id="section-3.5">
        <h3 id="name-liveliness">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-liveliness" class="section-name selfRef">Liveliness</a>
        </h3>
<p id="section-3.5-1">A media protocol can only be considered "live" if it can handle degraded network congestion.
MoqTransfork handles this by prioritizing the most important media while the remainder is starved.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The importance of each track/group/frame is signaled by the subscriber and the publisher will attempt to obey it.
Subscribers signal importance using Track Priority and Group Order.
Any data that is excessively starved may be dropped (by either endpoint) rather than block the live stream.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">A publisher that serves multiple sessions, commonly a relay, should prioritize on a per-session basis.
Alice may want real-time latency with a preference for audio, while Bob may want reliable playback while audio is muted.
A relay <span class="bcp14">MAY</span> forward subscriber preferences upstream, but when there is a conflict (like the above example), the publisher's preference should be used as a tiebreaker.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="workflow">
<section id="section-4">
      <h2 id="name-workflow">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-workflow" class="section-name selfRef">Workflow</a>
      </h2>
<p id="section-4-1">This section outlines the flow of messages within a MoqTransfork session.
See the section for Messages section for the specific encoding.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="connection">
<section id="section-4.1">
        <h3 id="name-connection">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-connection" class="section-name selfRef">Connection</a>
        </h3>
<p id="section-4.1-1">MoqTransfork runs on top of WebTransport.
WebTransport is a layer on top of QUIC and HTTP/3, required for web support.
The API is nearly identical to QUIC, however notably lacks stream IDs and has fewer available error codes.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">How the WebTransport connection is established is out-of-scope for this draft.
For example, a service <span class="bcp14">MAY</span> use the WebTransport handshake to perform authentication via the URL.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="termination">
<section id="section-4.2">
        <h3 id="name-termination">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-termination" class="section-name selfRef">Termination</a>
        </h3>
<p id="section-4.2-1">QUIC bidirectional streams have an independent send and receive direction.
Rather than deal with half-open states, MoqTransfork combines both sides.
If an endpoint closes the send direction of a stream, the peer <span class="bcp14">MUST</span> also close the send direction.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">MoqTransfork contains many long-lived transactions, such as subscriptions and announcements.
These are terminated when the underlying QUIC stream is terminated.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">To terminate a stream, an endpoint may:
- close the send direction (STREAM with FIN) to gracefully terminate (all messages are flushed).
- reset the send direction (RESET_STREAM) to immediately terminate.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">After resetting the send direction, an endpoint <span class="bcp14">MAY</span> close the recv direction (STOP_SENDING).
However, it is ultimately the other peer's responsibility to close their send direction.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handshake">
<section id="section-4.3">
        <h3 id="name-handshake">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-handshake" class="section-name selfRef">Handshake</a>
        </h3>
<p id="section-4.3-1">After a connection is established, the client opens a Session Stream and sends a SESSION_CLIENT message, to which the server replies with a SESSION_SERVER message.
The session is active until either endpoint closes or resets the Session Stream.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">This session handshake is used to negotiate the MoqTransfork version and any extensions.
See the Extension section for more information.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="streams">
<section id="section-5">
      <h2 id="name-streams">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-streams" class="section-name selfRef">Streams</a>
      </h2>
<p id="section-5-1">MoqTransfork involves many concurrent streams.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Each transactional action, such as a SUBSCRIBE, is sent over it's own stream.
If the stream is closed, potentially with an error, the transaction is terminated.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="bidirectional-streams">
<section id="section-5.1">
        <h3 id="name-bidirectional-streams">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-bidirectional-streams" class="section-name selfRef">Bidirectional Streams</a>
        </h3>
<p id="section-5.1-1">Bidirectional streams are primarily used for control streams.
There's a 1-byte STREAM_TYPE at the beginning of each stream.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Stream</th>
              <th class="text-left" rowspan="1" colspan="1">Creator</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Session</td>
              <td class="text-left" rowspan="1" colspan="1">Client</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Announced</td>
              <td class="text-left" rowspan="1" colspan="1">Subscriber</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x2</td>
              <td class="text-left" rowspan="1" colspan="1">Subscribe</td>
              <td class="text-left" rowspan="1" colspan="1">Subscriber</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x3</td>
              <td class="text-left" rowspan="1" colspan="1">Fetch</td>
              <td class="text-left" rowspan="1" colspan="1">Subscriber</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x4</td>
              <td class="text-left" rowspan="1" colspan="1">Info</td>
              <td class="text-left" rowspan="1" colspan="1">Subscriber</td>
            </tr>
          </tbody>
        </table>
<div id="session-1">
<section id="section-5.1.1">
          <h4 id="name-session-2">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-session-2" class="section-name selfRef">Session</a>
          </h4>
<p id="section-5.1.1-1">The Session stream contains all messages that are session level.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">The client <span class="bcp14">MUST</span> open a single Session Stream immediately
After establishing the QUIC/WebTransport session, the client opens a Session Stream.
There <span class="bcp14">MUST</span> be only one Session Stream per WebTransport session and its closure by either endpoint indicates the MoqTransfork session is closed.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">The client sends a SESSION_CLIENT message indicating the supported versions and extensions.
If the server does not support any of the client's versions, it <span class="bcp14">MUST</span> close the stream with an error code and <span class="bcp14">MAY</span> close the connection.
Otherwise, the server replies with a SESSION_SERVER message to complete the handshake.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">Afterwards, both endpoints <span class="bcp14">SHOULD</span> send SESSION_UPDATE messages, such as after a significant change in the session bitrate.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">This draft's version is combined with the constant <code>0xff0bad00</code>.
For example, moq-transfork-draft-03 is identified as <code>0xff0bad03</code>.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="announce">
<section id="section-5.1.2">
          <h4 id="name-announce">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-announce" class="section-name selfRef">Announce</a>
          </h4>
<p id="section-5.1.2-1">A subscriber can open a Announce Stream to discover tracks matching a prefix.
This is <span class="bcp14">OPTIONAL</span> and the application can determine track paths out-of-band.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">The subscriber starts the stream with a ANNOUNCE_PLEASE message.
The publisher replies with ANNOUNCE messages for any matching tracks.
Each ANNOUNCE message contains one of the following statuses:<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2-3.1">
              <p id="section-5.1.2-3.1.1"><code>active</code>: a matching track is available.<a href="#section-5.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-3.2">
              <p id="section-5.1.2-3.2.1"><code>ended</code>: a previously <code>active</code> track is no longer available.<a href="#section-5.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-3.3">
              <p id="section-5.1.2-3.3.1"><code>live</code>: all active tracks have been sent.<a href="#section-5.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.1.2-4">Each track starts as <code>ended</code> can transition to and from the <code>active</code>.
The subscriber <span class="bcp14">SHOULD</span> close the stream if it receives a duplicate status, such as two <code>active</code> statuses in a row or an <code>ended</code> without <code>active</code>.<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">The <code>live</code> status applies to the entire stream instead of a single track.
It <span class="bcp14">SHOULD</span> be sent by the publisher after all <code>active</code> ANNOUNCE messages have been sent.
The subscriber <span class="bcp14">SHOULD</span> use this as a signal that it has caught up, for example a track may not exist.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">Prefix matching is done on a part-by-part basis.
For example, a prefix of <code>["meeting"]</code> would match <code>["meeting", "1234"]</code> but not <code>["meeting-1234"]</code>.
The application is responsible for the encoding of the prefix, taking case to avoid any ambiguity such as multiple ways to encode the same value.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
<p id="section-5.1.2-7">There <span class="bcp14">MAY</span> be multiple Announce Streams, potentially containing overlapping prefixes, that get their own copy of each ANNOUNCE.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="subscribe">
<section id="section-5.2">
        <h3 id="name-subscribe">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-subscribe" class="section-name selfRef">Subscribe</a>
        </h3>
<p id="section-5.2-1">A subscriber can open a Subscribe Stream to request a Track.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The subscriber <span class="bcp14">MUST</span> start a Info Stream with a SUBSCRIBE message followed by any number SUBSCRIBE_UPDATE messages.
The publisher <span class="bcp14">MUST</span> reply with an INFO message followed by any number of SUBSCRIBE_GAP messages.
A publisher <span class="bcp14">MAY</span> reset the stream at any point if it is unable to serve the subscription.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The publisher <span class="bcp14">MUST</span> transmit a complete Group Stream or a SUBSCRIBE_GAP message for each Group within the subscription range.
This means the publisher <span class="bcp14">MUST</span> transmit a SUBSCRIBE_GAP if a Group Stream is reset.
The subscriber <span class="bcp14">SHOULD</span> close the subscription when all GROUP and SUBSCRIBE_GAP messages have been received, and the publisher <span class="bcp14">MAY</span> close the subscription after all messages have been acknowledged.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fetch">
<section id="section-5.3">
        <h3 id="name-fetch">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-fetch" class="section-name selfRef">Fetch</a>
        </h3>
<p id="section-5.3-1">A subscriber can open a Fetch Stream to receive a single Group at a specified offset.
This is primarily used to recover from an abrupt stream termination, causing the truncation of a Group.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The subscriber <span class="bcp14">MUST</span> start a Fetch Stream with a FETCH message followed by any number of FETCH_UPDATE messages.
The publisher <span class="bcp14">MUST</span> reply with the contents of a Group Stream, except starting at the specified offset <em>after</em> the GROUP message.
Note that this includes any FRAME messages.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">The fetch is active until both endpoints close the stream, or either endpoint resets the stream.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="info">
<section id="section-5.4">
        <h3 id="name-info">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-info" class="section-name selfRef">Info</a>
        </h3>
<p id="section-5.4-1">A subscriber can open an Info Stream to request information about a track.
This is not often necessary as SUBSCRIBE will trigger an INFO reply.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">The subscriber <span class="bcp14">MUST</span> start the stream with a INFO_PLEASE message.
The publisher <span class="bcp14">MUST</span> reply with an INFO message or reset the stream.
Both endpoints <span class="bcp14">MUST</span> close the stream afterwards.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unidirectional-streams">
<section id="section-5.5">
        <h3 id="name-unidirectional-streams">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-unidirectional-streams" class="section-name selfRef">Unidirectional Streams</a>
        </h3>
<p id="section-5.5-1">Unidirectional streams are used for data transmission.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Stream</th>
              <th class="text-left" rowspan="1" colspan="1">Creator</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Group</td>
              <td class="text-left" rowspan="1" colspan="1">Publisher</td>
            </tr>
          </tbody>
        </table>
<div id="group-1">
<section id="section-5.5.1">
          <h4 id="name-group-2">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-group-2" class="section-name selfRef">Group</a>
          </h4>
<p id="section-5.5.1-1">A publisher creates Group Streams in response to a Subscribe Stream.<a href="#section-5.5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.5.1-2">A Group Stream <span class="bcp14">MUST</span> start with a GROUP message and <span class="bcp14">MAY</span> be followed by any number of FRAME messages.
A Group <span class="bcp14">MAY</span> contain zero FRAME messages, potentially indicating a gap in the track.
A frame <span class="bcp14">MAY</span> contain an empty payload, potentially indicating a gap in the group.<a href="#section-5.5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.5.1-3">Both the publisher and subscriber <span class="bcp14">MAY</span> reset the stream at any time.
When a Group stream is reset, the publisher <span class="bcp14">MUST</span> send a SUBSCRIBE_GAP message on the corresponding Subscribe stream.
A future version of this draft may utilize reliable reset instead.<a href="#section-5.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="encoding">
<section id="section-6">
      <h2 id="name-encoding">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-encoding" class="section-name selfRef">Encoding</a>
      </h2>
<p id="section-6-1">This section covers the encoding of each message.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="streamtype">
<section id="section-6.1">
        <h3 id="name-stream_type">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-stream_type" class="section-name selfRef">STREAM_TYPE</a>
        </h3>
<p id="section-6.1-1">All streams start with a short header indicating the stream type.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
STREAM_TYPE {
  Stream Type (i)
}
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">The stream ID depends on if it's a bidirectional or unidirectional stream, as indicated in the Streams section.
A reciever <span class="bcp14">MUST</span> close the session if it receives an unknown stream type.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sessionclient">
<section id="section-6.2">
        <h3 id="name-session_client">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-session_client" class="section-name selfRef">SESSION_CLIENT</a>
        </h3>
<p id="section-6.2-1">The client initiates the session by sending a SESSION_CLIENT message.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
SESSION_CLIENT Message {
  Supported Versions Count (i)
  Supported Version (i)
  Extension Count (i)
  [
    Extension ID (i)
    Extension Payload (b)
  ]...
}
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sessionserver">
<section id="section-6.3">
        <h3 id="name-session_server">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-session_server" class="section-name selfRef">SESSION_SERVER</a>
        </h3>
<p id="section-6.3-1">The server responds with the selected version and any extensions.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-2">
<pre>
SESSION_SERVER Message {
  Selected Version (i)
  Extension Count (i)
  [
    Extension ID (i)
    Extension Payload (b)
  ]...
}
</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sessionupdate">
<section id="section-6.4">
        <h3 id="name-session_update">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-session_update" class="section-name selfRef">SESSION_UPDATE</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-6.4-1">
<pre>
SESSION_UPDATE Message {
  Session Bitrate (i)
}
</pre><a href="#section-6.4-1" class="pilcrow">¶</a>
</div>
<p id="section-6.4-2"><strong>Session Bitrate</strong>:
The estimated bitrate of the QUIC connection in bits per second.
This <span class="bcp14">SHOULD</span> be sourced directly from the QUIC congestion controller.
A value of 0 indicates that this information is not available.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="announceplease">
<section id="section-6.5">
        <h3 id="name-announce_please">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-announce_please" class="section-name selfRef">ANNOUNCE_PLEASE</a>
        </h3>
<p id="section-6.5-1">A subscriber sends an ANNOUNCE_PLEASE message to indicate it wants any corresponding ANNOUNCE messages.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5-2">
<pre>
ANNOUNCE_PLEASE Message {
  Track Prefix Parts (i),
  [ Track Prefix Part (b) ]
}
</pre><a href="#section-6.5-2" class="pilcrow">¶</a>
</div>
<p id="section-6.5-3"><strong>Track Prefix</strong>:
Indicate interest for any tracks that start with this prefix.
This uses byte-for-byte matching on each prefix part.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<p id="section-6.5-4">The publisher <span class="bcp14">MAY</span> close the stream with an error code if the prefix is too expansive.
Otherwise, the publisher <span class="bcp14">SHOULD</span> respond with an ANNOUNCE message for any matching tracks.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="announce-1">
<section id="section-6.6">
        <h3 id="name-announce-2">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-announce-2" class="section-name selfRef">ANNOUNCE</a>
        </h3>
<p id="section-6.6-1">A publisher sends an ANNOUNCE message to advertise a track.
Only the suffix is encoded on the wire, the full path is constructed by prepending the prefix from the corresponding ANNOUNCE_INTEREST.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-2">
<pre>
ANNOUNCE Message {
  Announce Status (i),
  [
    Track Suffix Parts (i),
    [ Track Suffix Part (b), ]
  ],
}
</pre><a href="#section-6.6-2" class="pilcrow">¶</a>
</div>
<p id="section-6.6-3"><strong>Announce Status</strong>:
A flag indicating the announce status.<a href="#section-6.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.6-4.1">
            <p id="section-6.6-4.1.1"><code>ended</code> (0): A path is no longer available.<a href="#section-6.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.6-4.2">
            <p id="section-6.6-4.2.1"><code>active</code> (1): A path is now available.<a href="#section-6.6-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.6-4.3">
            <p id="section-6.6-4.3.1"><code>live</code> (2): All active paths have been sent.<a href="#section-6.6-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.6-5"><strong>Track Suffix</strong>:
The track path suffix.
This field is not present for status <code>live</code>, which is not elegant I know.<a href="#section-6.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscribe-1">
<section id="section-6.7">
        <h3 id="name-subscribe-2">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-subscribe-2" class="section-name selfRef">SUBSCRIBE</a>
        </h3>
<p id="section-6.7-1">SUBSCRIBE is sent by a subscriber to start a subscription.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7-2">
<pre>
SUBSCRIBE Message {
  Subscribe ID (i)
  Track Path Parts (i)
  [ Track Path Part (b) ]
  Track Priority (i)
  Group Order (i)
  Group Expires (i)
  Group Min (i)
  Group Max (i)
}
</pre><a href="#section-6.7-2" class="pilcrow">¶</a>
</div>
<p id="section-6.7-3"><strong>Subscribe ID</strong>:
A unique idenfier chosen by the subscriber.
A Subscribe ID <span class="bcp14">MUST NOT</span> be reused within the same session, even if the prior subscription has been closed.<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<p id="section-6.7-4"><strong>Track Path Parts</strong>:
The number of parts in the track path.<a href="#section-6.7-4" class="pilcrow">¶</a></p>
<p id="section-6.7-5"><strong>Track Path</strong>:
The unique path of the track.
The number of parts <span class="bcp14">MUST</span> be within the range of 1 to 32.
The entire path combined <span class="bcp14">MUST</span> be smaller than 1024 bytes.<a href="#section-6.7-5" class="pilcrow">¶</a></p>
<p id="section-6.7-6"><strong>Track Priority</strong>:
The transmission priority of the subscription relative to all other active subscriptions within the session.
The publisher <span class="bcp14">SHOULD</span> transmit <em>higher</em> values first during congestion.<a href="#section-6.7-6" class="pilcrow">¶</a></p>
<p id="section-6.7-7"><strong>Group Order</strong>:
The transmission order of the Groups within the subscription.
The publisher <span class="bcp14">SHOULD</span> transmit groups based on their sequence number in default (0), ascending (1), or descending (2) order.<a href="#section-6.7-7" class="pilcrow">¶</a></p>
<p id="section-6.7-8"><strong>Group Expires</strong>:
A duration in milliseconds that applies to all Groups within the subscription.
The group <span class="bcp14">SHOULD</span> be dropped if this duration has elapsed after group has finished, including any time spent cached.
The publisher's Group Expires value (via INFO) <span class="bcp14">SHOULD</span> be used instead when smaller.<a href="#section-6.7-8" class="pilcrow">¶</a></p>
<p id="section-6.7-9"><strong>Group Min</strong>:
The minimum group sequence number plus 1.
A value of 0 indicates the latest Group Sequence as determined by the publisher.<a href="#section-6.7-9" class="pilcrow">¶</a></p>
<p id="section-6.7-10"><strong>Group Max</strong>:
The maximum group sequence number plus 1.
A value of 0 indicates there is no maximum and the subscription continues indefinitely.<a href="#section-6.7-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscribeupdate">
<section id="section-6.8">
        <h3 id="name-subscribe_update">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-subscribe_update" class="section-name selfRef">SUBSCRIBE_UPDATE</a>
        </h3>
<p id="section-6.8-1">A subscriber can modify a subscription with a SUBSCRIBE_UPDATE message.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.8-2">
<pre>
SUBSCRIBE_UPDATE Message {
  Track Priority (i)
  Group Order (i)
  Group Expires (i)
  Group Min (i)
  Group Max (i)
}
</pre><a href="#section-6.8-2" class="pilcrow">¶</a>
</div>
<p id="section-6.8-3"><strong>Track Priority</strong>:
The new track priority; see SUBSCRIBE.
The publisher <span class="bcp14">SHOULD</span> use the new priority for any blocked streams.<a href="#section-6.8-3" class="pilcrow">¶</a></p>
<p id="section-6.8-4"><strong>Group Order</strong>:
The new group order; see SUBSCRIBE.
The publisher <span class="bcp14">SHOULD</span> use the new order for any blocked streams.<a href="#section-6.8-4" class="pilcrow">¶</a></p>
<p id="section-6.8-5"><strong>Group Min</strong>:
The new minimum group sequence, or 0 if there is no update.
This value <span class="bcp14">MUST NOT</span> be smaller than prior SUBSCRIBE and SUBSCRIBE_UPDATE messages.<a href="#section-6.8-5" class="pilcrow">¶</a></p>
<p id="section-6.8-6"><strong>Group Max</strong>:
The new maximum group sequence, or 0 if there is no update.
This value <span class="bcp14">MUST NOT</span> be larger than prior SUBSCRIBE or SUBSCRIBE_UPDATE messages.<a href="#section-6.8-6" class="pilcrow">¶</a></p>
<p id="section-6.8-7">If the Min and Max are updated, the publisher <span class="bcp14">SHOULD</span> reset any blocked streams that are outside the new range.<a href="#section-6.8-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscribegap">
<section id="section-6.9">
        <h3 id="name-subscribe_gap">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-subscribe_gap" class="section-name selfRef">SUBSCRIBE_GAP</a>
        </h3>
<p id="section-6.9-1">A publisher transmits a SUBSCRIBE_GAP message when it is unable to serve a group for a SUBSCRIBE.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.9-2">
<pre>
SUBSCRIBE_GAP {
  Group Start (i)
  Group Count (i)
  Group Error Code (i)
}
</pre><a href="#section-6.9-2" class="pilcrow">¶</a>
</div>
<p id="section-6.9-3"><strong>Group Start</strong>:
The sequence number for the first group within the dropped range.<a href="#section-6.9-3" class="pilcrow">¶</a></p>
<p id="section-6.9-4"><strong>Group Count</strong>:
The number of additional groups after the first.
This value is 0 when only one group is dropped.<a href="#section-6.9-4" class="pilcrow">¶</a></p>
<p id="section-6.9-5"><strong>Error Code</strong>:
An error code indicated by the application.<a href="#section-6.9-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="info-1">
<section id="section-6.10">
        <h3 id="name-info-2">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-info-2" class="section-name selfRef">INFO</a>
        </h3>
<p id="section-6.10-1">The INFO message contains the current information about a track.
This is sent in response to a SUBSCRIBE or INFO_PLEASE message.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.10-2">
<pre>
INFO Message {
  Track Priority (i)
  Group Latest (i)
  Group Order (i)
  Group Expires (i)
}
</pre><a href="#section-6.10-2" class="pilcrow">¶</a>
</div>
<p id="section-6.10-3"><strong>Track Priority</strong>:
The priority of this track within the session.
The publisher <span class="bcp14">SHOULD</span> transmit subscriptions with <em>higher</em> values first during congestion.<a href="#section-6.10-3" class="pilcrow">¶</a></p>
<p id="section-6.10-4"><strong>Group Latest</strong>:
The latest group as currently known by the publisher.
A relay without an active subscription <span class="bcp14">SHOULD</span> forward this request upstream<a href="#section-6.10-4" class="pilcrow">¶</a></p>
<p id="section-6.10-5"><strong>Group Order</strong>:
The publisher's intended order of the groups within the subscription: none (0), ascending (1), or descending (2).<a href="#section-6.10-5" class="pilcrow">¶</a></p>
<p id="section-6.10-6"><strong>Group Expires</strong>:
A duration in milliseconds.
The group <span class="bcp14">SHOULD</span> be dropped if this duration has elapsed after group has finished, including any time spent cached.
The Subscriber's Group Expires value <span class="bcp14">SHOULD</span> be used instead when smaller.<a href="#section-6.10-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="infoplease">
<section id="section-6.11">
        <h3 id="name-info_please">
<a href="#section-6.11" class="section-number selfRef">6.11. </a><a href="#name-info_please" class="section-name selfRef">INFO_PLEASE</a>
        </h3>
<p id="section-6.11-1">The INFO_PLEASE message is used to request an INFO response.<a href="#section-6.11-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.11-2">
<pre>
INFO_PLEASE Message {
  Track Path Parts (i)
  [ Track Path Part (b) ]
}
</pre><a href="#section-6.11-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="fetch-1">
<section id="section-6.12">
        <h3 id="name-fetch-2">
<a href="#section-6.12" class="section-number selfRef">6.12. </a><a href="#name-fetch-2" class="section-name selfRef">FETCH</a>
        </h3>
<p id="section-6.12-1">A subscriber can request the transmission of a (partial) Group with a FETCH message.<a href="#section-6.12-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.12-2">
<pre>
FETCH Message {
  Track Path Parts (i)
  [ Track Path Part (b) ]
  Track Priority (i)
  Group Sequence (i)
  Frame Sequence (i)
}
</pre><a href="#section-6.12-2" class="pilcrow">¶</a>
</div>
<p id="section-6.12-3"><strong>Track Priority</strong>:
The priority of the group relative to all other FETCH and SUBSCRIBE requests within the session.
The publisher should transmit <em>higher</em> values first during congestion.<a href="#section-6.12-3" class="pilcrow">¶</a></p>
<p id="section-6.12-4"><strong>Group Sequence</strong>:
The sequence number of the group.<a href="#section-6.12-4" class="pilcrow">¶</a></p>
<p id="section-6.12-5"><strong>Frame Sequence</strong>:
The starting frame number.
All frames from this point forward are transmitted.<a href="#section-6.12-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fetchupdate">
<section id="section-6.13">
        <h3 id="name-fetch_update">
<a href="#section-6.13" class="section-number selfRef">6.13. </a><a href="#name-fetch_update" class="section-name selfRef">FETCH_UPDATE</a>
        </h3>
<p id="section-6.13-1">A subscriber can modify a FETCH request with a FETCH_UPDATE message.<a href="#section-6.13-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.13-2">
<pre>
FETCH_UPDATE Message {
  Track Priority (i)
}
</pre><a href="#section-6.13-2" class="pilcrow">¶</a>
</div>
<p id="section-6.13-3"><strong>Track Priority</strong>:
The priority of the group relative to all other FETCH and SUBSCRIBE requests within the session.
The publisher should transmit <em>higher</em> values first during congestion.<a href="#section-6.13-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="group-2">
<section id="section-6.14">
        <h3 id="name-group-3">
<a href="#section-6.14" class="section-number selfRef">6.14. </a><a href="#name-group-3" class="section-name selfRef">GROUP</a>
        </h3>
<p id="section-6.14-1">The GROUP message contains information about a Group, as well as a reference to the subscription being served.<a href="#section-6.14-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.14-2">
<pre>
GROUP Message {
  Subscribe ID (i)
  Group Sequence (i)
}
</pre><a href="#section-6.14-2" class="pilcrow">¶</a>
</div>
<p id="section-6.14-3"><strong>Subscribe ID</strong>:
The corresponding Subscribe ID.
This ID is used to distinguish between multiple subscriptions for the same track.<a href="#section-6.14-3" class="pilcrow">¶</a></p>
<p id="section-6.14-4"><strong>Group Sequence</strong>:
The sequence number of the group.<a href="#section-6.14-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frame-1">
<section id="section-6.15">
        <h3 id="name-frame-2">
<a href="#section-6.15" class="section-number selfRef">6.15. </a><a href="#name-frame-2" class="section-name selfRef">FRAME</a>
        </h3>
<p id="section-6.15-1">The FRAME message is a payload at a specific point of time.<a href="#section-6.15-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.15-2">
<pre>
FRAME Message {
  Payload (b)
}
</pre><a href="#section-6.15-2" class="pilcrow">¶</a>
</div>
<p id="section-6.15-3"><strong>Payload</strong>:
An application specific payload.
A generic library or relay <span class="bcp14">MUST NOT</span> inspect or modify the contents unless otherwise negotiated.<a href="#section-6.15-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="appendix-changelog">
<section id="section-7">
      <h2 id="name-appendix-changelog">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-appendix-changelog" class="section-name selfRef">Appendix: Changelog</a>
      </h2>
<p id="section-7-1">Notable changes between versions of this draft.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="moq-transfork-03">
<section id="section-7.1">
        <h3 id="name-moq-transfork-03">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-moq-transfork-03" class="section-name selfRef">moq-transfork-03</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.1-1.1">
            <p id="section-7.1-1.1.1">Broadcast and Track have been merged.<a href="#section-7.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.2">
            <p id="section-7.1-1.2.1">Tracks now have a variable length path instead of a (broadcast, name) tuple<a href="#section-7.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.3">
            <p id="section-7.1-1.3.1">ANNOUNCE contains the suffix instead of the full path.<a href="#section-7.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.4">
            <p id="section-7.1-1.4.1">ANNOUNCE contains a new status: active, ended, or live.<a href="#section-7.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.5">
            <p id="section-7.1-1.5.1">GROUP_DROP has been renamed to SUBSCRIBE_GAP.<a href="#section-7.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.6">
            <p id="section-7.1-1.6.1">FETCH is now at frame boundaries instead of byte offsets.<a href="#section-7.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.7">
            <p id="section-7.1-1.7.1">The protocol is more polite: some messages have been renamed to *_PLEASE.<a href="#section-7.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.8">
            <p id="section-7.1-1.8.1">Moved the use-cases appendix to a separate document.<a href="#section-7.1-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="moq-transfork-02">
<section id="section-7.2">
        <h3 id="name-moq-transfork-02">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-moq-transfork-02" class="section-name selfRef">moq-transfork-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.2-1.1">
            <p id="section-7.2-1.1.1">Document version numbers.<a href="#section-7.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.2">
            <p id="section-7.2-1.2.1">Added ANNOUNCE_INTEREST to opt-into ANNOUNCE messages.<a href="#section-7.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.3">
            <p id="section-7.2-1.3.1">Remove ROLE extension.<a href="#section-7.2-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="moq-transfork-01">
<section id="section-7.3">
        <h3 id="name-moq-transfork-01">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-moq-transfork-01" class="section-name selfRef">moq-transfork-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.3-1.1">
            <p id="section-7.3-1.1.1">Removed datagram support<a href="#section-7.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-1.2">
            <p id="section-7.3-1.2.1">Removed native QUIC support<a href="#section-7.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-1.3">
            <p id="section-7.3-1.3.1">Moved Expires from GROUP to SUBSCRIBE<a href="#section-7.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-1.4">
            <p id="section-7.3-1.4.1">Added FETCH_UPDATE<a href="#section-7.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-1.5">
            <p id="section-7.3-1.5.1">Added ROLE=Any<a href="#section-7.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-1.6">
            <p id="section-7.3-1.6.1">Track Priority is now descending.<a href="#section-7.3-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-2">Datagram and native QUIC support may be re-added in a future draft.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="moq-transfork-00">
<section id="section-7.4">
        <h3 id="name-moq-transfork-00">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-moq-transfork-00" class="section-name selfRef">moq-transfork-00</a>
        </h3>
<p id="section-7.4-1">Based on moq-transport-03.
The significant changes have been broken into sections.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.1">
            <p id="section-7.4-2.1.1">Bikeshedding<a href="#section-7.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.1.2.1">
                <p id="section-7.4-2.1.2.1.1">Renamed Track Namespace to Broadcast<a href="#section-7.4-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.1.2.2">
                <p id="section-7.4-2.1.2.2.1">Renamed Object to Frame<a href="#section-7.4-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.4-2.2">
            <p id="section-7.4-2.2.1">Each unidirectional stream contains a single group.<a href="#section-7.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.2.2.1">
                <p id="section-7.4-2.2.2.1.1">Removed stream per track.<a href="#section-7.4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.2.2.2">
                <p id="section-7.4-2.2.2.2.1">Removed stream per object.<a href="#section-7.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.4-2.3">
            <p id="section-7.4-2.3.1">Subscriber chooses track priority and group order.<a href="#section-7.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.4">
            <p id="section-7.4-2.4.1">Bidirectional control stream per ANNOUNCE/SUBSCRIBE/FETCH/INFO.<a href="#section-7.4-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.4.2.1">
                <p id="section-7.4-2.4.2.1.1">Removed ANNOUNCE_ERROR<a href="#section-7.4-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.4.2.2">
                <p id="section-7.4-2.4.2.2.1">Removed ANNOUNCE_DONE<a href="#section-7.4-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.4.2.3">
                <p id="section-7.4-2.4.2.3.1">Removed UNANNOUNCE<a href="#section-7.4-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.4.2.4">
                <p id="section-7.4-2.4.2.4.1">Removed SUBSCRIBE_OK<a href="#section-7.4-2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.4.2.5">
                <p id="section-7.4-2.4.2.5.1">Removed SUBSCRIBE_ERROR<a href="#section-7.4-2.4.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.4.2.6">
                <p id="section-7.4-2.4.2.6.1">Removed SUBSCRIBE_DONE<a href="#section-7.4-2.4.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.4.2.7">
                <p id="section-7.4-2.4.2.7.1">Removed UNSUBSCRIBE<a href="#section-7.4-2.4.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.4-2.5">
            <p id="section-7.4-2.5.1">Groups IDs are sequential.<a href="#section-7.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.6">
            <p id="section-7.4-2.6.1">All sequences are explicitly delivered.<a href="#section-7.4-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.6.2.1">
                <p id="section-7.4-2.6.2.1.1">(unreliable) GROUP for each sequence.<a href="#section-7.4-2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-2.6.2.2">
                <p id="section-7.4-2.6.2.2.1">Or (reliable) SUBSCRIBE_GAP when a stream is reset.<a href="#section-7.4-2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.4-2.7">
            <p id="section-7.4-2.7.1">Fetch Group via offset<a href="#section-7.4-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.8">
            <p id="section-7.4-2.8.1">Added INFO_PLEASE and INFO<a href="#section-7.4-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-2.9">
            <p id="section-7.4-2.9.1">Replaced SUBSCRIBE_OK with INFO<a href="#section-7.4-2.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">TODO Security<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-normative-references">
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="moqt">[moqt]</dt>
      <dd>
<span class="refAuthor">Curley, L.</span>, <span class="refAuthor">Pugin, K.</span>, <span class="refAuthor">Nandakumar, S.</span>, <span class="refAuthor">Vasiliev, V.</span>, and <span class="refAuthor">I. Swett</span>, <span class="refTitle">"Media over QUIC Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-moq-transport-07</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-moq-transport-07">https://datatracker.ietf.org/doc/html/draft-ietf-moq-transport-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Luke Curley</span></div>
<div dir="auto" class="left"><span class="org">Discord</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kixelated@gmail.com" class="email">kixelated@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
